@startuml US-08-09 Activity
start  
:User clicks "Checkout" button in cart popup or cart page;
:User is taken to checkout page;
repeat
    repeat
        :User selects shipping address;
    repeat while () is (Address Not Valid) not (Address Valid)
    :User selects payment method;
    if () then (Promo Code Entered)
        repeat
            :User enters promo code;
        repeat while () is (Promo Code Not Valid) not (Promo Code Valid)
    else (No Promo Code Entered)
    endif
    :User confirms order;
    :Order attempts to process;
    repeat
        :User enters billing information;
    repeat while () is (Billing Info Not Valid) not (Billing Info Valid)
    :User confirms order;
    :Order attempts to process;
    if () then (Order Successful)
        :Display order confirmation page;
        stop
    else (Order Fails)
        :Display error message;
        :Allow user to retry or cancel;
    endif
repeat while () is (Order Fails) not (Order Successful)
stop
@enduml